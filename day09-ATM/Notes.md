# Java基础入门 Day09 - ATM系统实战项目

## 1. 今日目标
* [x] 能够熟练使用 **ArrayList** 集合容器存储对象。
* [x] 掌握 **面向对象** 的编程思维（将数据和业务分离）。
* [x] 能够熟练使用 **String** 类的常用API（`substring`, `startsWith`, `equals`）。
* [x] 能够独立分析业务需求，并将其转化为代码逻辑。

## 2. 项目架构分析
不同于之前的单一类写法，今天的项目采用了标准的**面向对象设计**，分为三个类：

| 类名 | 类型 | 职责描述 |
| :--- | :--- | :--- |
| **Account** | 实体类 (JavaBean) | **存数据**。只负责定义账户的属性（卡号、姓名、余额、密码等），不包含复杂逻辑。 |
| **ATM** | 业务类 (Service) | **做业务**。核心类，包含所有的方法逻辑（开户、登录、转账、取款等），内部维护一个 `ArrayList`。 |
| **Test** | 测试类 (Entry) | **程序入口**。只包含 `main` 方法，负责创建 ATM 对象并启动系统。 |

## 3. 核心知识点应用

### 3.1 集合的应用 (ArrayList)
* **场景**：由于用户数量不确定，不能使用数组，必须使用 `ArrayList<Account>`。
* **操作**：
    * **增**：`accounts.add(acc)` (开户)
    * **删**：`accounts.remove(acc)` (销户)
    * **查**：遍历集合，通过 `acc.getCardId()` 比对卡号 (登录、转账、查重)。

### 3.2 字符串处理 (String API)
* **截取字符串**：在转账验证姓氏时，使用 `name.substring(1)` 获取第一个字之后的内容（例如 "黑马吴彦祖" -> "马吴彦祖"）。
* **前缀检查**：使用 `name.startsWith(preName)` 检查输入的是否是正确的姓氏。
* **内容比较**：密码和卡号的对比必须使用 `equals()`，不能用 `==`。

### 3.3 流程控制技巧
* **死循环菜单**：使用 `while(true)` 包裹主菜单，保证系统除非用户选择退出，否则一直运行。
* **`return` vs `break`**：
    * `break`：跳出 switch 或当前循环。
    * `return`：直接结束当前方法（例如登录成功后 `return` 结束登录方法；修改密码成功后 `return` 强制重新登录）。

## 4. 业务逻辑重难点 (复盘)

### 4.1 卡号生成 (createCardId)
* **难点**：卡号必须是8位，且**不能与现有卡号重复**。
* **逻辑**：
    1.  使用 `Random` 生成8位数字字符串。
    2.  **关键**：调用 `getAccountByCardId` 方法检查该卡号是否存在。
    3.  如果存在（重复），`continue` 继续循环重新生成。
    4.  如果不存在（可用），`break` 返回该卡号。

### 4.2 转账业务 (transferMoney)
* **逻辑链条最长**：
    1.  **非空判断**：系统必须有2个以上账户才能转账。
    2.  **余额判断**：自己要有钱。
    3.  **输入卡号**：不能输入自己的卡号。
    4.  **查找账户**：输入的对方卡号必须真实存在。
    5.  **姓名认证**：显示 `*彦祖`，让用户补全 `吴`，验证通过才放行。
    6.  **原子性操作**：自己的钱减少 (`setMoney`)，对方的钱增加 (`setMoney`)。

### 4.3 对象查找方法 (getAccountByCardId)
* **复用性**：这个方法被“登录”、“注册（查重）”、“转账”三个功能共同调用，体现了**方法抽取**的重要性。

## 5. 今日错题/Bug总结 (示例)
*(此处可以根据您实际编写时的错误填写，以下是常见错误)*
* **空指针异常**：在 `ATM` 类中忘记对 `accounts` 集合进行初始化 (`new ArrayList<>()`)，导致添加用户时报错。
* **输入缓冲区问题**：在使用 `Scanner` 时，连续混用 `next()` 和 `nextLine()` 导致的回车符吞噬问题（本次全用 `next()` 规避了此问题）。
* **对象引用**：修改余额时，没有使用 `setMoney`，或者忘记把修改后的值写回对象。

## 6. 学习心得
Day09 是从“写代码片段”到“写软件”的跨越。
* 深刻理解了**类与对象**的关系：`Account` 是图纸，`new Account()` 是具体的卡，`ArrayList` 是卡包。
* 学会了在编写代码前先画**业务流程图**（比如：先判断是否登录 -> 再判断余额 -> 再执行取款）。
* 这个项目虽然没有数据库，数据存在内存中（程序重启消失），但它模拟了真实的业务闭环，非常有成就感！

代码：day09-atm-code/src/com/siemonsele/test
